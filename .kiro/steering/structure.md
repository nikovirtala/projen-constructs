# Project Structure

## Directory Layout

```
.
├── src/                          # Source code
│   ├── components/               # Reusable Projen components
│   ├── projects/                 # Generated project type classes
│   ├── config.ts                 # Default configuration and component application
│   ├── errors.ts                 # Custom error classes
│   ├── index.ts                  # Public API exports
│   ├── project-generator.ts      # Code generation for project types
│   ├── project-type.ts           # Generated ProjectType enum
│   ├── utils.ts                  # Utility functions
│   └── versions.json             # Version constants (auto-updated)
├── test/                         # Test files (mirrors src/ structure)
│   ├── components/               # Component tests
│   ├── projects/                 # Project type tests
│   └── integration/              # Integration tests
├── lib/                          # Compiled JavaScript output
├── dist/                         # JSII distribution packages
├── docs/api/                     # Generated TypeDoc documentation
├── .projen/                      # Projen internal files
├── .projenrc.ts                  # Projen configuration (project definition)
└── scripts/                      # Build and utility scripts
```

## Source Code Organization

### Components (`src/components/`)

Reusable Projen components that can be added to any project:

- **vitest.ts** - Vitest testing framework integration
- **typedoc.ts** - TypeDoc documentation generation
- **mise.ts** - Mise version management
- **homebrew.ts** - Homebrew package management
- **colima.ts** - Colima container runtime
- **localstack.ts** - LocalStack AWS emulation
- **lambda-function-construct-generator.ts** - Lambda construct generation
- **bundle-lambda-function-code.ts** - Lambda code bundling utilities

Each component extends `projen.Component` and integrates with Projen's lifecycle.

### Projects (`src/projects/`)

Generated project type classes (do not edit directly):

- **typescript.generated.ts** - TypeScript project type
- **jsii.generated.ts** - JSII library project type
- **awscdk-typescript-app.generated.ts** - CDK TypeScript app project type
- **awscdk-construct-library.generated.ts** - CDK construct library project type
- **\*-options.generated.ts** - Corresponding options interfaces

These files are generated by `ProjectGenerator` during build.

### Core Files

- **config.ts** - Exports `defaultOptions` (configuration presets) and `applyDefaults()` (component application)
- **project-generator.ts** - `ProjectGenerator` component that generates project classes from templates
- **project-type.ts** - Generated enum of all available Projen project types
- **errors.ts** - Custom error classes for validation and error handling
- **utils.ts** - Utility functions (deepMerge, etc.)
- **index.ts** - Public API surface (exports components, projects, utilities)

## Test Organization

Tests mirror the `src/` directory structure:

- `test/components/` - Unit tests for components
- `test/projects/` - Unit tests for generated project types
- `test/integration/` - Integration tests
- `test/components/__snapshots__/` - Vitest snapshot files

## Code Generation Flow

1. `.projenrc.ts` defines `ProjectGenerator` instances
2. During build, `ProjectGenerator` reads Projen's JSII manifest
3. Generates `ProjectType` enum from manifest
4. Generates project classes in `src/projects/*.generated.ts`
5. Generates options interfaces in `src/projects/*-options.generated.ts`
6. TypeScript compiler outputs to `lib/`
7. JSII compiler packages for multiple languages in `dist/`

## Naming Conventions

- **Components**: PascalCase class names (e.g., `Vitest`, `TypeDoc`)
- **Generated files**: `*.generated.ts` suffix
- **Test files**: `*.test.ts` suffix
- **Options interfaces**: `{ClassName}Options` (e.g., `VitestOptions`)
- **Config properties**: camelCase (e.g., `vitestOptions`)

## Import Patterns

```typescript
// Public API imports (for consumers)
import { TypeScriptProject, Vitest } from "@nikovirtala/projen-constructs";

// Internal imports (within the project)
import { applyDefaults, defaultOptions } from "../config";
import { Vitest } from "../components/vitest";
import type { TypeScriptProjectOptions } from "./typescript-options.generated";
```

## File Ownership

**Edit directly:**
- `src/components/*.ts` (except *.generated.ts)
- `src/config.ts`
- `src/errors.ts`
- `src/utils.ts`
- `test/**/*.ts`
- `.projenrc.ts`

**Generated (do not edit):**
- `src/projects/*.generated.ts`
- `src/project-type.ts`
- `lib/**/*`
- `dist/**/*`
- Files with `~~ Generated by projen` header
- `.projen/**/*`
